<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Fed-WSVAD Documentation</title>
  <style>
    body { margin:0; font-family: Arial, sans-serif; background: var(--bg); color: var(--text); }
    :root { --bg: #ffffff; --text: #000000; --nav-bg: #f0f0f0; --nav-text: #000000; }
    body.dark { --bg: #202124; --text: #e8eaed; --nav-bg: #303134; --nav-text: #e8eaed; }
    .sidebar {
      position: fixed; left: 0; top: 0; bottom: 0; width: 250px;
      background: var(--nav-bg); color: var(--nav-text); overflow-y: auto; padding: 10px;
    }
    .sidebar ul { list-style-type: none; padding-left: 0; }
    .sidebar li { margin: 5px 0; }
    .sidebar a { text-decoration: none; color: var(--nav-text); }
    .sidebar a:hover { text-decoration: underline; }
    .sidebar .footer { position: absolute; bottom: 10px; width: 100%; text-align: center; font-size: 0.8em; }
    .content { margin-left: 260px; padding: 20px; }
    pre { background: #f5f5f5; padding: 10px; position: relative; overflow: auto; }
    body.dark pre { background: #333; }
    code { font-family: Consolas, monospace; }
    button.copy-btn {
      position: absolute; top: 5px; right: 5px; padding: 2px 6px; font-size: 0.8em;
    }
    #theme-toggle { position: fixed; top: 10px; right: 10px; }
    img { max-width: 100%; height: auto; }
  </style>
</head>
<body>
  <div class="sidebar">
    <ul>
<li><a href="#backbone-readme" data-file="backbone-readme" data-path="Backbone/README.md">Video Feature Extraction Toolkit (Backbone)</a>
  <ul>
    <li><a href="#-introduction" data-file="backbone-readme" data-path="Backbone/README.md">Introduction</a></li>
    <li><a href="#-pretrained-model" data-file="backbone-readme" data-path="Backbone/README.md">Pretrained Model</a></li>
    <li><a href="#-workflow-overview" data-file="backbone-readme" data-path="Backbone/README.md">Workflow Overview</a>
      <ul>
        <li><a href="#1-rgb-frame-extraction" data-file="backbone-readme" data-path="Backbone/README.md">RGB Frame Extraction</a></li>
        <li><a href="#2-feature-directory-setup" data-file="backbone-readme" data-path="Backbone/README.md">Feature Directory Setup</a></li>
        <li><a href="#3-feature-extraction" data-file="backbone-readme" data-path="Backbone/README.md">Feature Extraction</a></li>
        <li><a href="#4-feature-alignment" data-file="backbone-readme" data-path="Backbone/README.md">Feature Alignment</a></li>
      </ul></li>
    <li><a href="#-citation" data-file="backbone-readme" data-path="Backbone/README.md">Citation</a></li>
  </ul></li>
<li><a href="#fed-vad-jetson-agx-xavier-deployment-guide" data-file="fed-vad-jetson-agx-xavier-deployment-guide" data-path="Fed_VAD/Jetson AGX Xavier Deployment Guide.md">ðŸš€ Jetson AGX Xavier Deployment Guide</a></li>
<li><a href="#fed-vad-readme" data-file="fed-vad-readme" data-path="Fed_VAD/README.md">Fed-WSVAD Guide ðŸ“š</a></li>
<li><a href="#wsvad" data-file="wsvad" data-path="README.md">ðŸ“¹ Dual-detector Re-optimization for Federated Weakly Supervised Video Anomaly Detection Via Adaptive Dynamic Recursive Mapping</a>
  <ul>
    <li><a href="#wsvad" data-file="wsvad" data-path="README.md">WSVAD</a></li>
  </ul></li>
    </ul>
    <div class="footer">Maintained by Jiahang Li</div>
  </div>
  <button id="theme-toggle">Toggle Theme</button>
  <div class="content" id="content"></div>

  <!-- Marked library for Markdown parsing -->
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <script>
    const navLinks = document.querySelectorAll('.sidebar a');
    let currentFile = null;

    async function loadAndRender(path) {
      const rawUrl = "https://raw.githubusercontent.com/rekkles2/Fed_WSVAD/main/" + path;
      try {
        const res = await fetch(encodeURI(rawUrl));
        const text = await res.text();
        const html = marked.parse(text);
        document.getElementById('content').innerHTML = html;
        enhanceContent();
      } catch(e) {
        console.error("Failed to load " + path, e);
        document.getElementById('content').innerHTML = "<p>Failed to load content.</p>";
      }
    }

    function enhanceContent() {
      // Add ids to headings
      document.querySelectorAll("h1, h2, h3, h4, h5, h6").forEach(h => {
        if (!h.id) {
          let slug = h.textContent.trim().toLowerCase().replace(/[^a-z0-9]+/g, "-").replace(/^-+|-+$/g, "");
          if (slug) h.id = slug;
        }
      });
      // Add copy buttons to code blocks
      document.querySelectorAll('pre').forEach(pre => {
        pre.style.position = 'relative';
        const button = document.createElement('button');
        button.textContent = 'Copy';
        button.className = 'copy-btn';
        button.onclick = () => {
          const code = pre.querySelector('code');
          if (code) {
            navigator.clipboard.writeText(code.innerText);
          }
        };
        pre.appendChild(button);
      });
      // Adjust SVG image paths if needed
      document.querySelectorAll('img').forEach(img => {
        const src = img.getAttribute('src');
        if (src && src.startsWith("Figure/")) {
          img.setAttribute('src', src.replace("Figure/", ""));
        }
      });
    }

    navLinks.forEach(link => {
      link.addEventListener('click', (e) => {
        e.preventDefault();
        const fid = link.dataset.file;
        const path = link.dataset.path;
        const href = link.getAttribute('href').substring(1);
        const isSame = (fid === currentFile);
        // If different file, load it
        if (!isSame) {
          currentFile = fid;
          loadAndRender(path).then(() => {
            // if anchor in href and not file id, scroll
            if (href && href !== fid) {
              const el = document.getElementById(href);
              if (el) el.scrollIntoView();
            } else {
              window.scrollTo(0, 0);
            }
          });
        } else {
          // same file: scroll to anchor if not top
          if (href && href !== fid) {
            const el = document.getElementById(href);
            if (el) el.scrollIntoView();
          }
        }
      });
    });

    // Default load first file (main README)
    window.addEventListener('load', () => {
      const defaultLink = document.querySelector('.sidebar a[data-path="README.md"]');
      if (defaultLink) defaultLink.click();
    });

    // Theme toggle
    const themeToggle = document.getElementById('theme-toggle');
    themeToggle.addEventListener('click', () => {
      document.body.classList.toggle('dark');
    });
  </script>
</body>
</html>
